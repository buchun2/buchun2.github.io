<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/red/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"buchun2.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"red","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-1}}},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="bat相关用法记录">
<meta property="og:type" content="article">
<meta property="og:title" content="bat语句">
<meta property="og:url" content="https://buchun2.github.io/2025/03/12/bat%E8%AF%AD%E5%8F%A5/index.html">
<meta property="og:site_name" content="夜落">
<meta property="og:description" content="bat相关用法记录">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-03-11T16:00:00.000Z">
<meta property="article:modified_time" content="2025-03-13T05:34:42.660Z">
<meta property="article:author" content="夜落">
<meta property="article:tag" content="bat">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://buchun2.github.io/2025/03/12/bat%E8%AF%AD%E5%8F%A5/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://buchun2.github.io/2025/03/12/bat%E8%AF%AD%E5%8F%A5/","path":"2025/03/12/bat语句/","title":"bat语句"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>bat语句 | 夜落</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">夜落</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">夜落的空间</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A5%E6%94%B6%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="nav-number">1.</span> <span class="nav-text">接收输入参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A5%E5%8F%97%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">接受多个参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%A1%E7%90%86%E5%91%98%E8%BF%90%E8%A1%8C"><span class="nav-number">3.</span> <span class="nav-text">管理员运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3%E8%BF%90%E8%A1%8C"><span class="nav-number">4.</span> <span class="nav-text">隐藏窗口运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E5%8F%96ip"><span class="nav-number">5.</span> <span class="nav-text">提取ip</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%97%E4%B8%BE%E7%9B%AE%E5%BD%95%E4%BC%A0%E5%8F%82"><span class="nav-number">6.</span> <span class="nav-text">列举目录传参</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%B6%E9%97%B4"><span class="nav-number">7.</span> <span class="nav-text">时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E5%A4%A7%E5%B0%8F"><span class="nav-number">8.</span> <span class="nav-text">比较大小</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="nav-number">9.</span> <span class="nav-text">下载文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%89%A7%E8%A1%8C"><span class="nav-number">10.</span> <span class="nav-text">判断执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1%E6%98%AF%E5%90%A6%E5%BC%80%E5%90%AF"><span class="nav-number">11.</span> <span class="nav-text">共享服务是否开启</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E7%A6%81%E7%94%A8%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1"><span class="nav-number">12.</span> <span class="nav-text">选择禁用共享服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E8%BF%9E%E6%8E%A5%E6%96%AD%E5%BC%80"><span class="nav-number">13.</span> <span class="nav-text">共享连接断开</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%BB%E9%99%A4%E9%87%8D%E5%A4%8D"><span class="nav-number">14.</span> <span class="nav-text">去除重复</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6"><span class="nav-number">15.</span> <span class="nav-text">字符长度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E5%AF%86%E7%A0%81"><span class="nav-number">16.</span> <span class="nav-text">简单密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%93%E6%9D%9F%E5%90%8E%E7%AA%97%E5%8F%A3%E4%B8%8D%E5%85%B3%E9%97%AD"><span class="nav-number">17.</span> <span class="nav-text">结束后窗口不关闭</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%8F%90%E5%8F%96"><span class="nav-number">18.</span> <span class="nav-text">计划任务提取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A6%81%E7%94%A8%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="nav-number">19.</span> <span class="nav-text">禁用计划任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E7%94%A8%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1"><span class="nav-number">20.</span> <span class="nav-text">启用远程桌面服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E7%9B%AE%E5%BD%95%E7%AE%80%E5%86%99"><span class="nav-number">21.</span> <span class="nav-text">系统目录简写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E5%BE%84%E7%BC%A9%E5%86%99"><span class="nav-number">22.</span> <span class="nav-text">路径缩写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="nav-number">23.</span> <span class="nav-text">获取文件属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E6%8F%90%E5%8F%96"><span class="nav-number">24.</span> <span class="nav-text">文件路径提取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E5%88%99"><span class="nav-number">25.</span> <span class="nav-text">防火墙规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A6%81%E7%94%A8%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1-1"><span class="nav-number">26.</span> <span class="nav-text">禁用计划任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E6%A0%BC%E4%B8%80%E5%B9%B6%E8%BE%93%E5%87%BA"><span class="nav-number">27.</span> <span class="nav-text">空格一并输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E5%AD%97%E7%AC%A6%E7%9A%84%E8%A1%8C%E5%89%8D%E5%8A%A0%E6%8D%A2%E8%A1%8C"><span class="nav-number">28.</span> <span class="nav-text">指定字符的行前加换行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E8%AE%A1%E7%AE%97"><span class="nav-number">29.</span> <span class="nav-text">运行时间计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%90%8D"><span class="nav-number">30.</span> <span class="nav-text">获取用户名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%89%E5%BE%85300%E7%A7%92"><span class="nav-number">31.</span> <span class="nav-text">等待300秒</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for%E5%BE%AA%E7%8E%AF%E5%86%85%E6%97%B6%E9%97%B4%E6%9B%B4%E6%94%B9"><span class="nav-number">32.</span> <span class="nav-text">for循环内时间更改</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-number">33.</span> <span class="nav-text">拷贝文件夹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%88%AA%E5%8F%96%E5%8F%8C%E5%BC%95%E5%8F%B7%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="nav-number">34.</span> <span class="nav-text">截取双引号之间的字符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%A8%8B%E5%BA%8F%E8%B7%AF%E5%BE%84"><span class="nav-number">35.</span> <span class="nav-text">获取程序路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-number">36.</span> <span class="nav-text">进程详细信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%97%A5%E5%BF%97"><span class="nav-number">37.</span> <span class="nav-text">获取日志</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ftp-%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6"><span class="nav-number">38.</span> <span class="nav-text">ftp 传输文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#share-%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6"><span class="nav-number">39.</span> <span class="nav-text">share 传输文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E7%A8%8B%E5%BA%8F%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85"><span class="nav-number">40.</span> <span class="nav-text">判断程序是否安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%8A%A0%E5%9F%9F"><span class="nav-number">41.</span> <span class="nav-text">判断是否加域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%9B%AE%E5%BD%95%E5%92%8C%E5%AD%90%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80"><span class="nav-number">42.</span> <span class="nav-text">修改目录和子目录文件后缀</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC"><span class="nav-number">43.</span> <span class="nav-text">操作系统版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%AF%E5%90%A6%E6%9C%89%E5%B1%8F%E4%BF%9D%E4%BF%9D%E6%8A%A4%EF%BC%8C%E5%A4%9A%E9%95%BF%E6%97%B6%E9%97%B4"><span class="nav-number">44.</span> <span class="nav-text">是否有屏保保护，多长时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8Brdp%E9%93%BE%E6%8E%A5%E8%AE%B0%E5%BD%95"><span class="nav-number">45.</span> <span class="nav-text">查看rdp链接记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6hash"><span class="nav-number">46.</span> <span class="nav-text">计算文件hash</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">夜落</p>
  <div class="site-description" itemprop="description">个人笔记</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/buchun2" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;buchun2" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://buchun2.github.io/2025/03/12/bat%E8%AF%AD%E5%8F%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="夜落">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="夜落">
      <meta itemprop="description" content="个人笔记">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="bat语句 | 夜落">
      <meta itemprop="description" content="bat相关用法记录">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          bat语句
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-12 00:00:00" itemprop="dateCreated datePublished" datetime="2025-03-12T00:00:00+08:00">2025-03-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-13 13:34:42" itemprop="dateModified" datetime="2025-03-13T13:34:42+08:00">2025-03-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/bat/" itemprop="url" rel="index"><span itemprop="name">bat</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

            <div class="post-description">bat相关用法记录</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="接收输入参数"><a href="#接收输入参数" class="headerlink" title="接收输入参数"></a>接收输入参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setlocal enabledelayedexpansion</span><br><span class="line">set /p str=请输入要查找的字符串，回车确认：</span><br><span class="line">%str%</span><br></pre></td></tr></table></figure>

<h2 id="接受多个参数"><a href="#接受多个参数" class="headerlink" title="接受多个参数"></a>接受多个参数</h2><p>123.bat 123 111</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set /a source_file=%1</span><br><span class="line">set /a destination_folder=%2</span><br></pre></td></tr></table></figure>



<h2 id="管理员运行"><a href="#管理员运行" class="headerlink" title="管理员运行"></a>管理员运行</h2><p>双击自动管理员身份运行，在bat文件开头 @echo off  后加即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%1 mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;cmd.exe&quot;,&quot;/c &quot;^&amp;chr(34)^&amp;&quot;%~0&quot;^&amp;chr(34)^&amp;&quot; ::&quot;,&quot;%cd%&quot;,&quot;runas&quot;,1)(window.close)&amp;&amp;exit </span><br><span class="line"></span><br><span class="line">cd /d %~dp0</span><br></pre></td></tr></table></figure>

<h2 id="隐藏窗口运行"><a href="#隐藏窗口运行" class="headerlink" title="隐藏窗口运行"></a>隐藏窗口运行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">title &quot;copy UI&quot;</span><br><span class="line">::mode con cols=15 lines=1</span><br><span class="line">if &quot;%1&quot; == &quot;h&quot; goto begin</span><br><span class="line">mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,0)(window.close)&amp;&amp;exit</span><br><span class="line">:begin</span><br></pre></td></tr></table></figure>

<h2 id="提取ip"><a href="#提取ip" class="headerlink" title="提取ip"></a>提取ip</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;tokens=16&quot; %%a in (&#x27;ipconfig ^|find /i &quot;ipv4&quot;&#x27;) do (</span><br><span class="line"> set IP=%%a</span><br><span class="line">)</span><br><span class="line">echo %IP%</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;tokens=4&quot; %%a in (&#x27;route print^|findstr 0.0.0.0.*0.0.0.0&#x27;) do (</span><br><span class="line"> set IP=%%a</span><br><span class="line">)</span><br><span class="line">echo %IP%</span><br></pre></td></tr></table></figure>

<h2 id="列举目录传参"><a href="#列举目录传参" class="headerlink" title="列举目录传参"></a>列举目录传参</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">for /d %%s in (C:\Users\*) do (</span><br><span class="line">    echo %%s</span><br><span class="line">	call :subdir %%s</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line">:subdir</span><br><span class="line">if %1%==&quot;&quot; (</span><br><span class="line">	call :end</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">for /r &quot;%1\Local Settings\Temp\&quot; %%b in (*) do (</span><br><span class="line">	if %%~zb gtr 10485760 (</span><br><span class="line">		echo %nn%-%ny%-%nr%--%th%-%tm%-%ts%  %%~b &gt;&gt;dell.log</span><br><span class="line">		del &quot;%%~b&quot;</span><br><span class="line">	)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">set nn=%date:~,4%</span><br><span class="line">set ny=%date:~5,2%</span><br><span class="line">set nr=%date:~8,2%</span><br><span class="line">set th=%time:~,2%</span><br><span class="line">set tm=%time:~3,2%</span><br><span class="line">set ts=%time:~6,2%</span><br><span class="line">set ti=%nn%-%ny%-%nr%--%th%-%tm%-%ts%</span><br></pre></td></tr></table></figure>

<h2 id="比较大小"><a href="#比较大小" class="headerlink" title="比较大小"></a>比较大小</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EQU - 等于    NEQ - 不等于     LSS - 小于   LEQ - 小于或等于   GTR - 大于    GEQ - 大于或等于</span><br></pre></td></tr></table></figure>

<h2 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitsadmin /transfer “任务名字” /download /priority normal “下载链接” “保存位置”</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil -urlcache -split -f  http://127.0.0.1:8098//client.exe d:\\client.exe</span><br></pre></td></tr></table></figure>



<h2 id="判断执行"><a href="#判断执行" class="headerlink" title="判断执行"></a>判断执行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;tokens=2 delims=\&quot; %%i in (&#x27;whoami&#x27;) do (</span><br><span class="line">if %%i neq &quot;administrator&quot; ( </span><br><span class="line">goto domain</span><br><span class="line">) else ( </span><br><span class="line">goto continue</span><br><span class="line">)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="共享服务是否开启"><a href="#共享服务是否开启" class="headerlink" title="共享服务是否开启"></a>共享服务是否开启</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sc query LanmanServer |findstr /i &quot;RUNNING&quot;</span><br><span class="line">::if ERRORLEVEL 0 (echo !!!服务未开启. ) else (echo 服务已开启！)</span><br><span class="line">if %errorlevel% neq 0  (</span><br><span class="line">echo &quot;当前server服务未开启!&quot;</span><br><span class="line">) else (</span><br><span class="line">echo &quot;当前server服务已开启!&quot;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="选择禁用共享服务"><a href="#选择禁用共享服务" class="headerlink" title="选择禁用共享服务"></a>选择禁用共享服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">set /p server=是否可以禁用共享服务,选择Y禁用共享服务,选择N不禁用y/n:</span><br><span class="line">if /i &quot;%server%&quot;==&quot;y&quot; goto stop-server</span><br><span class="line">if /i &quot;%server%&quot;==&quot;n&quot; goto not-stop-server</span><br><span class="line">goto re-install</span><br><span class="line"></span><br><span class="line">:stop-server</span><br><span class="line">net stop LanmanServer /Y</span><br><span class="line">sc.exe config LanmanServer start= disabled </span><br><span class="line">ECHO *******************共享服务禁用完毕！************************</span><br><span class="line">goto jiayu</span><br><span class="line"></span><br><span class="line">:not-stop-server</span><br><span class="line">ECHO *******************需要共享服务，暂不禁用！************************</span><br><span class="line">echo.</span><br></pre></td></tr></table></figure>

<h2 id="共享连接断开"><a href="#共享连接断开" class="headerlink" title="共享连接断开"></a>共享连接断开</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net use * /del</span><br><span class="line">net use \\172.20.184.29\IPC$ /del</span><br></pre></td></tr></table></figure>



<h2 id="去除重复"><a href="#去除重复" class="headerlink" title="去除重复"></a>去除重复</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort /C /UNIQUE &quot;123.txt&quot; /O &quot;outgoing.txt&quot;</span><br></pre></td></tr></table></figure>

<h2 id="字符长度"><a href="#字符长度" class="headerlink" title="字符长度"></a>字符长度</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">setlocal enabledelayedexpansion</span><br><span class="line">set /p str=请输入字符串，回车确认：</span><br><span class="line">set count=0</span><br><span class="line">:loop</span><br><span class="line">if not &quot;!str:~%count%,1!&quot; == &quot;&quot; (</span><br><span class="line">	set /a count+=1</span><br><span class="line">	goto loop</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="简单密码"><a href="#简单密码" class="headerlink" title="简单密码"></a>简单密码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">if &quot;%str%&quot;==&quot;12345678&quot; goto getip</span><br><span class="line">goto SETIP</span><br><span class="line"></span><br><span class="line">:getip</span><br><span class="line">echo 等于成立执行</span><br><span class="line">goto SETIP2</span><br><span class="line"></span><br><span class="line">:SETIP</span><br><span class="line">echo 不成立执行</span><br><span class="line"></span><br><span class="line">:SETIP2</span><br><span class="line">echo 均执行</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="结束后窗口不关闭"><a href="#结束后窗口不关闭" class="headerlink" title="结束后窗口不关闭"></a>结束后窗口不关闭</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd /c start dir：会打开一个新窗口后执行dir指令，原窗口会关闭；</span><br><span class="line">cmd /k start dir：会打开一个新窗口后执行dir指令，原窗口不会关闭。</span><br><span class="line">cmd /k    结束后窗口不关闭</span><br></pre></td></tr></table></figure>

<h2 id="计划任务提取"><a href="#计划任务提取" class="headerlink" title="计划任务提取"></a>计划任务提取</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SCHTASKS /Query /FO csv /NH /V &gt;&gt;schd.txt</span><br><span class="line">for /f &quot;tokens=1,2,3,4,6,8,9,19,20 delims=,&quot; %a in (&#x27;find /i &quot;就绪&quot; schd.txt&#x27;) do @echo %a %b %c %d %e %f %g %h %i</span><br></pre></td></tr></table></figure>

<h2 id="禁用计划任务"><a href="#禁用计划任务" class="headerlink" title="禁用计划任务"></a>禁用计划任务</h2><p>禁用根目录下的计划任务C:\Windows\System32\Tasks</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@echo off </span><br><span class="line">set FolderName=C:\Windows\System32\Tasks</span><br><span class="line">for /f &quot;tokens=*&quot; %%i in (&#x27;dir /b /a-d /o-d &quot;%FolderName%\&quot;&#x27;) do (</span><br><span class="line">  schtasks /change /tn &quot;%%i&quot; /disable</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<h2 id="启用远程桌面服务"><a href="#启用远程桌面服务" class="headerlink" title="启用远程桌面服务"></a>启用远程桌面服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sc.exe config TermService start= auto </span><br><span class="line">net start TermService /Y</span><br></pre></td></tr></table></figure>

<h2 id="系统目录简写"><a href="#系统目录简写" class="headerlink" title="系统目录简写"></a>系统目录简写</h2><p>Windows系统常用环境变量(目录简写)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">%ALLUSERSPROFILE% C:\Documents and Settings\All Users </span><br><span class="line">%USERPROFILE% C:\Documents and Settings\当前用户名 </span><br><span class="line">%HOMEPATH% C:\Documents and Settings\当前用户名 </span><br><span class="line">%SYSTEMROOT% C:\WINDOWS </span><br><span class="line">%WINDIR% C:\WINDOWS </span><br><span class="line">%ComSpec% C:\WINDOWS\System32\cmd.exe </span><br><span class="line">%APPDATA% C:\Documents and Settings\当前用户名\Application Data </span><br><span class="line">%ALLAPPDATA% C:\Documents and Settings\All Users\Application Data </span><br><span class="line">%SYSTEMDRIVE% C: </span><br><span class="line">%HOMEDRIVE% C: </span><br><span class="line">%TEMP% 和 %TMP% C:\Documents and Settings\当前用户名\Local Settings\Temp </span><br><span class="line">%ProgramFiles% C:\Program Files </span><br><span class="line">%CommonProgramFiles% C:\Program Files\Common Files </span><br><span class="line">Docum~1 Documents and Settings </span><br><span class="line">progra~1 Program Files </span><br><span class="line">%systemdrive%：Windows系统所在磁盘分区，通常就是C盘的根目录 </span><br><span class="line">%systemroot%,%windir%：Windows系统所在的目录，通常是C:\Winows </span><br><span class="line">%programfiles%：通常情况下是C:\program files </span><br><span class="line">%commonprogramfiles%：公用文件目录，通常是C:\program files\common files </span><br><span class="line">%userprofile%：当前账户的用户目录，通常是C:\documents and settings\当前用户名 </span><br><span class="line">%alluserprofile%：所有用户的用户目录，通常是C:\documents and settings\all user </span><br><span class="line">%temp%,%tmp%：当前用户的临时文件目录，通常是C:\documents and settings\当前用户名\local settings\temp </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="路径缩写"><a href="#路径缩写" class="headerlink" title="路径缩写"></a>路径缩写</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">当前盘符：%~d0</span><br><span class="line">当前路径：%cd%</span><br><span class="line">当前执行命令行：%0</span><br><span class="line">当前bat文件路径：%~dp0</span><br><span class="line">当前bat文件短路径：%~sdp0</span><br></pre></td></tr></table></figure>

<h2 id="获取文件属性"><a href="#获取文件属性" class="headerlink" title="获取文件属性"></a>获取文件属性</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cd /d %~dp0</span><br><span class="line">for /R %~dp0 %%i in (*) do ( </span><br><span class="line">set str_info=%%~tzfi</span><br><span class="line">echo !str_info!&gt;&gt;D-1234.txt </span><br><span class="line">)</span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">2025/03/12 22:07 403 D:\桌面\111\123.bat </span><br><span class="line">2025/03/05 14:52 22518 D:\桌面\111\123.jpg </span><br><span class="line">2025/03/10 17:44 71670 D:\桌面\111\out1.jpg </span><br><span class="line"></span><br><span class="line">在批处理开头加入cd /d %~dp0 一行代码就真真实实地做到“编写一次，到处运行”。%0是批处理文件本身的路径，%~dp进行扩展， d向前扩展到驱动器，p往后扩展到路径。例如，你的bat文件在e:/mybat/test.bat,则%0就是e:/mybat/test.bat, %~dp0是e:/mybat/。 </span><br><span class="line">另外，%i提取第i个命令选项，例如%1提取第1个option，i可以取值从1到9 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">		%~0： 取文件名（名+扩展名） </span><br><span class="line">        %~f0：取全路径 </span><br><span class="line">        %~d0：取驱动器名 </span><br><span class="line">        %~p0：只取路径（不包驱动器） </span><br><span class="line">        %~n0：只取文件名 </span><br><span class="line">        %~x0：只取文件扩展名 </span><br><span class="line">        %~s0：取缩写全路径名 </span><br><span class="line">        %~a0：取文件属性 </span><br><span class="line">        %~t0：取文件修改时间 </span><br><span class="line">        %~z0：取文件大小 </span><br><span class="line">以上选项可以组合起来使用。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">echo off</span><br><span class="line">setlocal enabledelayedexpansion  </span><br><span class="line">set &quot;EXCEL_DIR=%cd%&quot;</span><br><span class="line">for /R %EXCEL_DIR% %%f in (*.txt) do (</span><br><span class="line">	set &quot;FILE_PATH=%%f&quot;</span><br><span class="line">	echo 完整的路径: !FILE_PATH!</span><br><span class="line">	set &quot;FILE_DIR=%%~dpf&quot;</span><br><span class="line">	echo 所在的目录: !FILE_DIR!</span><br><span class="line">	set &quot;FILE_NAME=%%~nf&quot;</span><br><span class="line">	echo 简略文件名: !FILE_NAME!</span><br><span class="line">	set &quot;FILE_EXT=%%~xf&quot;</span><br><span class="line">	echo 文件后缀名: !FILE_EXT!</span><br><span class="line">	set &quot;FILE_FULLNAME=%%~nxf&quot;</span><br><span class="line">	echo 完整文件名: !FILE_FULLNAME!</span><br><span class="line">	set &quot;FILE_PATH_NO_EXT=%%~dpnf&quot;</span><br><span class="line">	echo 无后缀路径: !FILE_PATH_NO_EXT!</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<h2 id="文件路径提取"><a href="#文件路径提取" class="headerlink" title="文件路径提取"></a>文件路径提取</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if not exist result mkdir result</span><br><span class="line">for /R &quot;%str%:\&quot; %%s in (*) do ( </span><br><span class="line">echo %%s&gt;&gt;.\result\.txt</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="防火墙规则"><a href="#防火墙规则" class="headerlink" title="防火墙规则"></a>防火墙规则</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh.exe advfirewall firewall add rule name=deny445 dir=in protocol=tcp localport=445 action=block</span><br></pre></td></tr></table></figure>

<h2 id="禁用计划任务-1"><a href="#禁用计划任务-1" class="headerlink" title="禁用计划任务"></a>禁用计划任务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">schtasks /change /tn &quot;\npcapwatchdog&quot; /disable</span><br><span class="line">schtasks /change /tn &quot;\npcapwatchdog&quot; /enable</span><br></pre></td></tr></table></figure>

<h2 id="空格一并输出"><a href="#空格一并输出" class="headerlink" title="空格一并输出"></a>空格一并输出</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;tokens=*&quot; %%i in (&#x27;findstr /v /i &quot;\Microsoft\ \Symantec&quot; 1111.txt&#x27;)do echo %%i</span><br></pre></td></tr></table></figure>

<h2 id="指定字符的行前加换行"><a href="#指定字符的行前加换行" class="headerlink" title="指定字符的行前加换行"></a>指定字符的行前加换行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo. &gt;123222.txt</span><br><span class="line">FOR /F &quot;tokens=*&quot; %%i IN (&#x27;findstr /i &quot;HKEY_LOCAL_MACHINE DisPlayname InstallDate&quot; installreg.txt&#x27;) DO (</span><br><span class="line">    echo %%i  |findstr &quot;HKEY_LOCAL_MACHINE&quot; &gt;nul &amp;&amp; ( </span><br><span class="line">	echo. &gt;&gt;123222.txt</span><br><span class="line">	echo %%i &gt;&gt;123222.txt ) || ( </span><br><span class="line">	echo %%i &gt;&gt;123222.txt )</span><br></pre></td></tr></table></figure>

<h2 id="运行时间计算"><a href="#运行时间计算" class="headerlink" title="运行时间计算"></a>运行时间计算</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">set time_begin=%time:~0,-3% </span><br><span class="line">echo 脚本开始运行时间是 %time_begin% </span><br><span class="line">:: 小于10的小时数前有空格，要做去空格操作 </span><br><span class="line">for /f &quot;tokens=1,2,3 delims=:&quot; %%i in (&quot;%time_begin%&quot;) do ( </span><br><span class="line">set /a hour_b=%%i </span><br><span class="line">set /a munite_b=%%j </span><br><span class="line">set /a second_b=%%k </span><br><span class="line">) </span><br><span class="line"></span><br><span class="line">这里是正常程序</span><br><span class="line"></span><br><span class="line">set time_end=%time:~0,-3% </span><br><span class="line">for /f &quot;tokens=1,2,3 delims=:&quot; %%i in (&quot;%time_end%&quot;) do ( </span><br><span class="line">set /a hour_e=%%i </span><br><span class="line">set /a munite_e=%%j </span><br><span class="line">set /a second_e=%%k </span><br><span class="line">) </span><br><span class="line"></span><br><span class="line">:: 一定要按照 秒=&gt;分钟=&gt;小时 的顺序操作 </span><br><span class="line">if %second_e% lss %second_b% ( </span><br><span class="line">set /a munite_e=%munite_e%-1 </span><br><span class="line">set /a second_e=%second_e%+60 </span><br><span class="line">) </span><br><span class="line">set /a second_=%second_e%-%second_b% </span><br><span class="line">if %munite_e% lss %munite_b% ( </span><br><span class="line">set /a hour_e=%hour_e%-1 </span><br><span class="line">set /a munite_e=%munite_e%+60 </span><br><span class="line">) </span><br><span class="line">set /a munite_=%munite_e%-%munite_b% </span><br><span class="line">if %hour_e% lss %hour_b% ( </span><br><span class="line">set /a hour_e=%hour_e%+24 </span><br><span class="line">) </span><br><span class="line">set /a hour_=%hour_e%-%hour_b% </span><br><span class="line"></span><br><span class="line">echo 脚本结束运行的时间是 %time_end% </span><br><span class="line">echo 共花费了 %hour_% 小时 %munite_% 分 %second_% 秒 </span><br></pre></td></tr></table></figure>

<h2 id="获取用户名"><a href="#获取用户名" class="headerlink" title="获取用户名"></a>获取用户名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">echo 本机上拥有以下用户：</span><br><span class="line">echo.</span><br><span class="line">for /f &quot;skip=4 tokens=1-3&quot; %%i in (&#x27;net user&#x27;) do (</span><br><span class="line">    if not &quot;%%i&quot;==&quot;命令成功完成。&quot; echo %%i</span><br><span class="line">    if not &quot;%%j&quot;==&quot;&quot; echo %%j</span><br><span class="line">    if not &quot;%%k&quot;==&quot;&quot; echo %%k</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line">echo 当前登录本机的账户是：%username%</span><br></pre></td></tr></table></figure>

<h2 id="等待300秒"><a href="#等待300秒" class="headerlink" title="等待300秒"></a>等待300秒</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">下面这条命令会等待300秒，并且只能按下CTRL+C来跳过</span><br><span class="line">TIMEOUT /T 300 /NOBREAK</span><br></pre></td></tr></table></figure>

<h2 id="for循环内时间更改"><a href="#for循环内时间更改" class="headerlink" title="for循环内时间更改"></a>for循环内时间更改</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"></span><br><span class="line">set aa=!time!</span><br><span class="line">echo !aa!  start</span><br><span class="line">TIMEOUT /T 2</span><br><span class="line">echo !aa! on scan... ...</span><br></pre></td></tr></table></figure>



<h2 id="拷贝文件夹"><a href="#拷贝文件夹" class="headerlink" title="拷贝文件夹"></a>拷贝文件夹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">::拷贝系统日志</span><br><span class="line">set evenlog=&quot;Logs&quot;</span><br><span class="line">::拷贝PerfLogs</span><br><span class="line">set PerfLogs=&quot;PerfLogs&quot;</span><br><span class="line">::拷贝Prefetch</span><br><span class="line">set Prefetch=&quot;Prefetch&quot;</span><br><span class="line">mkdir %evenlog%</span><br><span class="line">xcopy C:\Windows\System32\winevt\Logs\*.* %evenlog% /s /e /y</span><br><span class="line">mkdir %PerfLogs%</span><br><span class="line">xcopy C:\PerfLogs\*.* %PerfLogs% /s /e /y</span><br><span class="line">mkdir %Prefetch%</span><br><span class="line">xcopy C:\Windows\Prefetch\*.* %Prefetch% /s /e /y</span><br></pre></td></tr></table></figure>

<h2 id="截取双引号之间的字符"><a href="#截取双引号之间的字符" class="headerlink" title="截取双引号之间的字符"></a>截取双引号之间的字符</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /f tokens^=2^ delims^=^&quot; %%i in (url.txt) do @echo %%~i &gt;&gt;result.txt</span><br></pre></td></tr></table></figure>

<h2 id="获取程序路径"><a href="#获取程序路径" class="headerlink" title="获取程序路径"></a>获取程序路径</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic process where name=&#x27;SunloginClient.exe&#x27; get ExecutablePath</span><br></pre></td></tr></table></figure>

<h2 id="进程详细信息"><a href="#进程详细信息" class="headerlink" title="进程详细信息"></a>进程详细信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wmic process get Description,executablepath,processid,CreationDate,CommandLine,OSName  /format:htable  &gt;&gt;%IP%-usersid-process-detail.html</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="获取日志"><a href="#获取日志" class="headerlink" title="获取日志"></a>获取日志</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wevtutil epl System  system.evtx</span><br><span class="line">wevtutil epl Application Application.evtx</span><br><span class="line">wevtutil epl Security  Security.evtx</span><br><span class="line">wevtutil epl &quot;Windows PowerShell&quot; PowerShell.evtx</span><br><span class="line">wevtutil epl Microsoft-Windows-WMI-Activity/Operational wmi.evtx</span><br></pre></td></tr></table></figure>

<h2 id="ftp-传输文件"><a href="#ftp-传输文件" class="headerlink" title="ftp 传输文件"></a>ftp 传输文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">echo 正在进行结果传输...........</span><br><span class="line">set ftpfilename=autoftp.cfg</span><br><span class="line">echo open 127.0.0.1&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">echo anonymous&gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">echo passwd &gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">echo Prompt&gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">::echo lcd d:\&gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">echo mput %IP%.txt %IP%.html %IP%-usersid-process-detail.html %IP%-schtasks.txt&gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">echo bye&gt;&gt;&quot;%ftpfilename%&quot;</span><br><span class="line">ftp -s:&quot;%ftpfilename%&quot; </span><br><span class="line">del &quot;%ftpfilename%&quot;</span><br></pre></td></tr></table></figure>

<h2 id="share-传输文件"><a href="#share-传输文件" class="headerlink" title="share 传输文件"></a>share 传输文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">net use  \\127.0.0.1\checkinfo &quot;MHC@#$Nh4ma78&quot; /user:&quot;sharkname&quot; &gt;nul 2&gt;nul</span><br><span class="line">copy  /b /y &quot;%IP%.txt&quot; &quot;\\127.0.0.1\checkinfo\&quot; &gt;&gt;%IP%.txt</span><br><span class="line">copy  /b /y &quot;%IP%.html&quot; &quot;\\127.0.0.1\checkinfo\&quot;</span><br><span class="line">copy  /b /y &quot;%IP%-usersid-process-detail.html&quot; &quot;\\127.0.0.1\checkinfo\&quot; &gt;&gt;%IP%.txt</span><br><span class="line">copy  /b /y &quot;%IP%-schtasks.txt&quot; &quot;\\127.0.0.1\checkinfo\&quot;</span><br><span class="line">net use \\127.0.0.1\checkinfo /del &gt;nul 2&gt;nul</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="判断程序是否安装"><a href="#判断程序是否安装" class="headerlink" title="判断程序是否安装"></a>判断程序是否安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tasklist /nh|find /i &quot;ccSvcHst.exe&quot;</span><br><span class="line">if ERRORLEVEL 1 (echo --------Symantec未安装,请安装并更新Symantec-------- ) else ( echo --------Symantec已安装--------)</span><br></pre></td></tr></table></figure>

<h2 id="判断是否加域"><a href="#判断是否加域" class="headerlink" title="判断是否加域"></a>判断是否加域</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">wmic ntdomain get domainname | findstr /i &quot;这里域的名字&quot;</span><br><span class="line">if %errorlevel% neq 0  (</span><br><span class="line">goto domain</span><br><span class="line">) else (</span><br><span class="line">goto continue</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:domain</span><br><span class="line">echo &quot;-未加域，请加域-&quot; </span><br><span class="line">goto end</span><br><span class="line"></span><br><span class="line">:continue</span><br><span class="line">echo &quot;-已加域-&quot; </span><br><span class="line">goto end</span><br><span class="line">:end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="修改目录和子目录文件后缀"><a href="#修改目录和子目录文件后缀" class="headerlink" title="修改目录和子目录文件后缀"></a>修改目录和子目录文件后缀</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /r %%a in (*.xlsx) do ren &quot;%%a&quot; &quot;%%~na.xls&quot;</span><br></pre></td></tr></table></figure>

<h2 id="操作系统版本"><a href="#操作系统版本" class="headerlink" title="操作系统版本"></a>操作系统版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic OS get Caption,CSDVersion,OSArchitecture,Version</span><br></pre></td></tr></table></figure>

<h2 id="是否有屏保保护，多长时间"><a href="#是否有屏保保护，多长时间" class="headerlink" title="是否有屏保保护，多长时间"></a>是否有屏保保护，多长时间</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic desktop get screensaversecure,screensavertimeout</span><br></pre></td></tr></table></figure>

<h2 id="查看rdp链接记录"><a href="#查看rdp链接记录" class="headerlink" title="查看rdp链接记录"></a>查看rdp链接记录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmdkey /list</span><br></pre></td></tr></table></figure>

<h2 id="计算文件hash"><a href="#计算文件hash" class="headerlink" title="计算文件hash"></a>计算文件hash</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe -hashfile 1.txt</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/bat/" rel="tag"><i class="fa fa-tag"></i> bat</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/03/12/burp%E6%89%A9%E5%B1%95%E6%8F%92%E4%BB%B6/" rel="prev" title="burp suite扩展插件">
                  <i class="fa fa-angle-left"></i> burp suite扩展插件
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/03/12/bat%E8%BD%ACexe/" rel="next" title="bat转exe">
                  bat转exe <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="选择语言">
      
        <option value="zh-CN" data-href="/2025/03/12/bat%E8%AF%AD%E5%8F%A5/" selected="">
          简体中文
        </option>
      
        <option value="en" data-href="/en/2025/03/12/bat%E8%AF%AD%E5%8F%A5/" selected="">
          English
        </option>
      
    </select>
  </div>

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">夜落</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">77k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:10</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="50" alpha="0.2" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"buchun2","repo":"MYblogtalk","client_id":"Ov23liMCjyNxUA0xAJYa","client_secret":"19b4d0da3f099a7d0dc5ad44fc0582136fa60abf","admin_user":"buchun2","distraction_free_mode":true,"proxy":null,"language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"721a31b4de819d92626908ee381c6426"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
